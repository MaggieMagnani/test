-- tela_explosao.lua

local mon
for _, nome in ipairs(peripheral.getNames()) do
  if peripheral.getType(nome) == "monitor" then
    mon = peripheral.wrap(nome)
    break
  end
end

if not mon then
  print("Nenhum monitor encontrado!")
  return
end

mon.setTextScale(0.5)
local w, h = mon.getSize()
local cx, cy = math.floor(w / 2), math.floor(h / 2)

local cores = {
  colors.red, colors.orange, colors.yellow,
  colors.green, colors.blue, colors.purple,
  colors.magenta, colors.cyan, colors.white
}

-- Desenha um pixel
local function draw(x, y, color)
  if x >= 1 and x <= w and y >= 1 and y <= h then
    mon.setCursorPos(x, y)
    mon.setBackgroundColor(color)
    mon.write(" ")
  end
end

-- Gera partÃ­culas
while true do
  local partCount = math.random(15, 30)
  local particles = {}

  for i = 1, partCount do
    local angle = math.random() * math.pi * 2
    local speed = math.random() * 1.5 + 0.5
    local cor = cores[math.random(#cores)]

    table.insert(particles, {
      x = cx, y = cy, dx = math.cos(angle) * speed, dy = math.sin(angle) * speed, color = cor
    })
  end

  for step = 1, 6 do
    mon.setBackgroundColor(colors.black)
    mon.clear()

    for _, p in ipairs(particles) do
      local x = math.floor(p.x + p.dx * step)
      local y = math.floor(p.y + p.dy * step)
      draw(x, y, p.color)
    end

    sleep(0.08)
  end

  sleep(0.1)
end
